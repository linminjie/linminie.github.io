"use strict";(globalThis.webpackChunkmimoe_devportal=globalThis.webpackChunkmimoe_devportal||[]).push([[6087],{4450(e,s,n){n.r(s),n.d(s,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>d,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"api/context/storage","title":"context.storage","description":"Persistent storage API for key-value data, tagged items, embeddings, and files","source":"@site/docs/api/context/storage.md","sourceDirName":"api/context","slug":"/api/context/storage","permalink":"/mimOE-devportal/docs/api/context/storage","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"context.storage","description":"Persistent storage API for key-value data, tagged items, embeddings, and files"},"sidebar":"apiSidebar","previous":{"title":"context.http","permalink":"/mimOE-devportal/docs/api/context/http"},"next":{"title":"context.info & context.env","permalink":"/mimOE-devportal/docs/api/context/info"}}');var t=n(4848),i=n(8453);const d={sidebar_position:3,title:"context.storage",description:"Persistent storage API for key-value data, tagged items, embeddings, and files"},c="context.storage",a={},l=[{value:"Quick Reference",id:"quick-reference",level:2},{value:"Basic Storage",id:"basic-storage",level:2},{value:"getItem()",id:"getitem",level:3},{value:"setItem()",id:"setitem",level:3},{value:"removeItem()",id:"removeitem",level:3},{value:"Tagged Storage",id:"tagged-storage",level:2},{value:"setItemWithTag()",id:"setitemwithtag",level:3},{value:"removeItemsByTag()",id:"removeitemsbytag",level:3},{value:"eachItemByTag()",id:"eachitembytag",level:3},{value:"Embedding (Vector) Operations",id:"embedding-vector-operations",level:2},{value:"setEmbeddingWithTag()",id:"setembeddingwithtag",level:3},{value:"getEmbedding()",id:"getembedding",level:3},{value:"removeEmbedding()",id:"removeembedding",level:3},{value:"removeEmbeddingsByTag()",id:"removeembeddingsbytag",level:3},{value:"similaritySearch()",id:"similaritysearch",level:3},{value:"Iteration",id:"iteration",level:2},{value:"eachItem()",id:"eachitem",level:3},{value:"Pagination &amp; Querying",id:"pagination--querying",level:2},{value:"getJsonItemsPaginated()",id:"getjsonitemspaginated",level:3},{value:"Options",id:"options",level:4},{value:"orderBy Format",id:"orderby-format",level:4},{value:"filters Format",id:"filters-format",level:4},{value:"Example",id:"example",level:4},{value:"Transactions",id:"transactions",level:2},{value:"lockExecute()",id:"lockexecute",level:3},{value:"File Operations",id:"file-operations",level:2},{value:"saveFile()",id:"savefile",level:3},{value:"deleteFile()",id:"deletefile",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Use Key Prefixes",id:"use-key-prefixes",level:3},{value:"Use Tags for Collections",id:"use-tags-for-collections",level:3},{value:"Use Transactions for Consistency",id:"use-transactions-for-consistency",level:3},{value:"Related",id:"related",level:2}];function o(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"contextstorage",children:"context.storage"})}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"context.storage"})," object provides persistent storage for your mim. It supports key-value storage, tagged items, vector embeddings, pagination, transactions, and file operations."]}),"\n",(0,t.jsx)(s.p,{children:"Each mim has its own isolated storage database. Data stored by one mim is not accessible to other mims."}),"\n",(0,t.jsx)(s.h2,{id:"quick-reference",children:"Quick Reference"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Category"}),(0,t.jsx)(s.th,{children:"Methods"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Basic"})}),(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.a,{href:"#getitem",children:(0,t.jsx)(s.code,{children:"getItem"})}),", ",(0,t.jsx)(s.a,{href:"#setitem",children:(0,t.jsx)(s.code,{children:"setItem"})}),", ",(0,t.jsx)(s.a,{href:"#removeitem",children:(0,t.jsx)(s.code,{children:"removeItem"})})]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Tagged"})}),(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.a,{href:"#setitemwithtag",children:(0,t.jsx)(s.code,{children:"setItemWithTag"})}),", ",(0,t.jsx)(s.a,{href:"#removeitemsbytag",children:(0,t.jsx)(s.code,{children:"removeItemsByTag"})}),", ",(0,t.jsx)(s.a,{href:"#eachitembytag",children:(0,t.jsx)(s.code,{children:"eachItemByTag"})})]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Embeddings"})}),(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.a,{href:"#setembeddingwithtag",children:(0,t.jsx)(s.code,{children:"setEmbeddingWithTag"})}),", ",(0,t.jsx)(s.a,{href:"#getembedding",children:(0,t.jsx)(s.code,{children:"getEmbedding"})}),", ",(0,t.jsx)(s.a,{href:"#removeembedding",children:(0,t.jsx)(s.code,{children:"removeEmbedding"})}),", ",(0,t.jsx)(s.a,{href:"#removeembeddingsbytag",children:(0,t.jsx)(s.code,{children:"removeEmbeddingsByTag"})}),", ",(0,t.jsx)(s.a,{href:"#similaritysearch",children:(0,t.jsx)(s.code,{children:"similaritySearch"})})]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Iteration"})}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.a,{href:"#eachitem",children:(0,t.jsx)(s.code,{children:"eachItem"})})})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Pagination"})}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.a,{href:"#getjsonitemspaginated",children:(0,t.jsx)(s.code,{children:"getJsonItemsPaginated"})})})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Transactions"})}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.a,{href:"#lockexecute",children:(0,t.jsx)(s.code,{children:"lockExecute"})})})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Files"})}),(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.a,{href:"#savefile",children:(0,t.jsx)(s.code,{children:"saveFile"})}),", ",(0,t.jsx)(s.a,{href:"#deletefile",children:(0,t.jsx)(s.code,{children:"deleteFile"})})]})]})]})]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"basic-storage",children:"Basic Storage"}),"\n",(0,t.jsx)(s.h3,{id:"getitem",children:"getItem()"}),"\n",(0,t.jsx)(s.p,{children:"Retrieves a value from storage by key."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"context.storage.getItem(key) \u2192 string | null\n"})}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsx)(s.tbody,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"key"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"The key to lookup"})]})})]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Returns:"})," The value as a string, or ",(0,t.jsx)(s.code,{children:"null"})," if not found."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"app.get('/user/:id', (request, response) => {\n    var user = context.storage.getItem('user:' + request.params.id);\n    if (user) {\n        response.end(user);\n    } else {\n        response.statusCode = 404;\n        response.end('Not found');\n    }\n});\n"})}),"\n",(0,t.jsx)(s.h3,{id:"setitem",children:"setItem()"}),"\n",(0,t.jsx)(s.p,{children:"Stores a value with the specified key."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"context.storage.setItem(key, value)\n"})}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"key"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"The key to store under"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"value"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"The value to store"})]})]})]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"app.post('/user', (request, response) => {\n    var user = JSON.parse(request.body);\n    context.storage.setItem('user:' + user.id, JSON.stringify(user));\n    response.end('User saved');\n});\n"})}),"\n",(0,t.jsx)(s.h3,{id:"removeitem",children:"removeItem()"}),"\n",(0,t.jsx)(s.p,{children:"Removes a value from storage by key."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"context.storage.removeItem(key)\n"})}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsx)(s.tbody,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"key"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"The key to remove"})]})})]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"app.delete('/user/:id', (request, response) => {\n    context.storage.removeItem('user:' + request.params.id);\n    response.end('User deleted');\n});\n"})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"tagged-storage",children:"Tagged Storage"}),"\n",(0,t.jsx)(s.p,{children:"Tags allow you to categorize items and perform bulk operations."}),"\n",(0,t.jsx)(s.h3,{id:"setitemwithtag",children:"setItemWithTag()"}),"\n",(0,t.jsx)(s.p,{children:"Stores a value with an associated tag."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"context.storage.setItemWithTag(key, value, tag)\n"})}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"key"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"The key to store under"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"value"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"The value to store"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"tag"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"The tag to associate"})]})]})]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"app.post('/user', (request, response) => {\n    var user = JSON.parse(request.body);\n    context.storage.setItemWithTag(\n        'user:' + user.id,\n        JSON.stringify(user),\n        'users'\n    );\n    response.end('User saved');\n});\n"})}),"\n",(0,t.jsx)(s.h3,{id:"removeitemsbytag",children:"removeItemsByTag()"}),"\n",(0,t.jsx)(s.p,{children:"Removes all items with a specific tag."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"context.storage.removeItemsByTag(tag)\n"})}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsx)(s.tbody,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"tag"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"The tag identifying items to remove"})]})})]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"app.delete('/users/all', (request, response) => {\n    context.storage.removeItemsByTag('users');\n    response.end('All users deleted');\n});\n"})}),"\n",(0,t.jsx)(s.h3,{id:"eachitembytag",children:"eachItemByTag()"}),"\n",(0,t.jsx)(s.p,{children:"Iterates through all items with a specific tag."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"context.storage.eachItemByTag(tag, callback)\n"})}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"tag"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"The tag to filter by"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"callback"})}),(0,t.jsx)(s.td,{children:"function"}),(0,t.jsxs)(s.td,{children:["Called for each item: ",(0,t.jsx)(s.code,{children:"(key, value) => boolean"})]})]})]})]}),"\n",(0,t.jsxs)(s.p,{children:["The callback receives ",(0,t.jsx)(s.code,{children:"key"})," and ",(0,t.jsx)(s.code,{children:"value"})," as arguments. Return ",(0,t.jsx)(s.code,{children:"true"})," to continue iteration, ",(0,t.jsx)(s.code,{children:"false"})," to stop."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"app.get('/users', (request, response) => {\n    var users = [];\n    context.storage.eachItemByTag('users', function(key, value) {\n        users.push(JSON.parse(value));\n        return true;  // continue iteration\n    });\n    response.end(JSON.stringify(users));\n});\n"})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"embedding-vector-operations",children:"Embedding (Vector) Operations"}),"\n",(0,t.jsx)(s.p,{children:"Store and search vector embeddings for semantic similarity."}),"\n",(0,t.jsx)(s.h3,{id:"setembeddingwithtag",children:"setEmbeddingWithTag()"}),"\n",(0,t.jsx)(s.p,{children:"Stores a vector embedding with an associated tag."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"context.storage.setEmbeddingWithTag(key, embedding, tag)\n"})}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"key"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"The key to store under"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"embedding"})}),(0,t.jsx)(s.td,{children:"number[]"}),(0,t.jsx)(s.td,{children:"The vector embedding as array of numbers"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"tag"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"The tag to associate"})]})]})]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"app.post('/document', (request, response) => {\n    var body = JSON.parse(request.body);\n    context.storage.setEmbeddingWithTag(\n        'doc:' + body.id,\n        body.embedding,\n        'documents'\n    );\n    response.end('Embedding stored');\n});\n"})}),"\n",(0,t.jsx)(s.h3,{id:"getembedding",children:"getEmbedding()"}),"\n",(0,t.jsx)(s.p,{children:"Retrieves a vector embedding from storage."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"context.storage.getEmbedding(key) \u2192 number[] | null\n"})}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsx)(s.tbody,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"key"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"The key of the embedding"})]})})]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Returns:"})," The embedding vector as array, or ",(0,t.jsx)(s.code,{children:"null"})," if not found."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"app.get('/document/:id/embedding', (request, response) => {\n    var embedding = context.storage.getEmbedding('doc:' + request.params.id);\n    if (embedding) {\n        response.end(JSON.stringify({ embedding: embedding }));\n    } else {\n        response.statusCode = 404;\n        response.end('Not found');\n    }\n});\n"})}),"\n",(0,t.jsx)(s.h3,{id:"removeembedding",children:"removeEmbedding()"}),"\n",(0,t.jsx)(s.p,{children:"Removes an embedding from storage."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"context.storage.removeEmbedding(key)\n"})}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsx)(s.tbody,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"key"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"The key of the embedding to remove"})]})})]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"app.delete('/document/:id/embedding', (request, response) => {\n    context.storage.removeEmbedding('doc:' + request.params.id);\n    response.end('Embedding removed');\n});\n"})}),"\n",(0,t.jsx)(s.h3,{id:"removeembeddingsbytag",children:"removeEmbeddingsByTag()"}),"\n",(0,t.jsx)(s.p,{children:"Removes all embeddings with a specific tag."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"context.storage.removeEmbeddingsByTag(tag)\n"})}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsx)(s.tbody,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"tag"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"The tag identifying embeddings to remove"})]})})]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"app.delete('/documents/embeddings', (request, response) => {\n    context.storage.removeEmbeddingsByTag('documents');\n    response.end('All document embeddings removed');\n});\n"})}),"\n",(0,t.jsx)(s.h3,{id:"similaritysearch",children:"similaritySearch()"}),"\n",(0,t.jsx)(s.p,{children:"Performs vector similarity search to find embeddings most similar to a query vector."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"context.storage.similaritySearch(queryEmbedding, topN, tag, callback)\n"})}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"queryEmbedding"})}),(0,t.jsx)(s.td,{children:"number[]"}),(0,t.jsx)(s.td,{children:"The query vector"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"topN"})}),(0,t.jsx)(s.td,{children:"number"}),(0,t.jsx)(s.td,{children:"Maximum number of results"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"tag"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Tag to filter embeddings by"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"callback"})}),(0,t.jsx)(s.td,{children:"function"}),(0,t.jsxs)(s.td,{children:["Called for each result: ",(0,t.jsx)(s.code,{children:"(key, similarity) => void"})]})]})]})]}),"\n",(0,t.jsxs)(s.p,{children:["The callback receives ",(0,t.jsx)(s.code,{children:"key"})," and ",(0,t.jsx)(s.code,{children:"similarity"})," (0 to 1, where 1 is most similar)."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"app.post('/search', (request, response) => {\n    var body = JSON.parse(request.body);\n    var results = [];\n\n    context.storage.similaritySearch(\n        body.queryEmbedding,\n        10,\n        'documents',\n        function(key, similarity) {\n            results.push({ key: key, similarity: similarity });\n        }\n    );\n\n    response.end(JSON.stringify(results));\n});\n"})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"iteration",children:"Iteration"}),"\n",(0,t.jsx)(s.h3,{id:"eachitem",children:"eachItem()"}),"\n",(0,t.jsx)(s.p,{children:"Iterates through all items in storage."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"context.storage.eachItem(callback)\n"})}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsx)(s.tbody,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"callback"})}),(0,t.jsx)(s.td,{children:"function"}),(0,t.jsxs)(s.td,{children:["Called for each item: ",(0,t.jsx)(s.code,{children:"(key, value) => boolean"})]})]})})]}),"\n",(0,t.jsxs)(s.p,{children:["Return ",(0,t.jsx)(s.code,{children:"true"})," to continue, ",(0,t.jsx)(s.code,{children:"false"})," to stop."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"app.get('/dump', (request, response) => {\n    var items = [];\n    context.storage.eachItem(function(key, value) {\n        items.push({ key: key, value: value });\n        return true;\n    });\n    response.end(JSON.stringify(items));\n});\n"})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"pagination--querying",children:"Pagination & Querying"}),"\n",(0,t.jsx)(s.h3,{id:"getjsonitemspaginated",children:"getJsonItemsPaginated()"}),"\n",(0,t.jsx)(s.p,{children:"Retrieves items with pagination, filtering, sorting, and grouping. Values must be valid JSON strings to use JSON path features."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"context.storage.getJsonItemsPaginated(offset, limit, callback, options)\n"})}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"offset"})}),(0,t.jsx)(s.td,{children:"number"}),(0,t.jsx)(s.td,{children:"Number of records to skip (>= 0)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"limit"})}),(0,t.jsx)(s.td,{children:"number"}),(0,t.jsx)(s.td,{children:"Number of records to return (>= 1)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"callback"})}),(0,t.jsx)(s.td,{children:"function"}),(0,t.jsxs)(s.td,{children:["Called with results: ",(0,t.jsx)(s.code,{children:"(items, totalCount) => void"})]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"options"})}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{children:"Query options (optional)"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"options",children:"Options"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Option"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"tag"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Filter by specific tag"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"order"})}),(0,t.jsx)(s.td,{children:"number"}),(0,t.jsx)(s.td,{children:"Simple ordering: positive for ASC, negative for DESC"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"orderBy"})}),(0,t.jsx)(s.td,{children:"array"}),(0,t.jsx)(s.td,{children:"Advanced ordering by JSON paths"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"filters"})}),(0,t.jsx)(s.td,{children:"array"}),(0,t.jsx)(s.td,{children:"Array of filter conditions"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"groupBy"})}),(0,t.jsx)(s.td,{children:"array"}),(0,t.jsx)(s.td,{children:"Array of JSON paths to group by"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"orderby-format",children:"orderBy Format"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"orderBy: [\n    { jsonPath: '$.fieldName', order: 1 },   // ASC\n    { jsonPath: '$.otherField', order: -1 }  // DESC\n]\n"})}),"\n",(0,t.jsx)(s.h4,{id:"filters-format",children:"filters Format"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"filters: [\n    {\n        jsonPath: '$.status',\n        comparisonOperator: '=',  // =, !=, >, <, >=, <=, LIKE, IS NULL, IS NOT NULL\n        value: 'active'\n    }\n]\n"})}),"\n",(0,t.jsx)(s.h4,{id:"example",children:"Example"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"app.get('/users', (request, response) => {\n    var page = parseInt(request.query.page) || 0;\n    var pageSize = parseInt(request.query.pageSize) || 10;\n    var offset = page * pageSize;\n\n    context.storage.getJsonItemsPaginated(\n        offset,\n        pageSize,\n        function(items, totalCount) {\n            response.end(JSON.stringify({\n                data: JSON.parse(items),\n                pagination: {\n                    page: page,\n                    pageSize: pageSize,\n                    totalCount: totalCount,\n                    totalPages: Math.ceil(totalCount / pageSize)\n                }\n            }));\n        },\n        {\n            tag: 'users',\n            orderBy: [{ jsonPath: '$.createdAt', order: -1 }],\n            filters: [\n                { jsonPath: '$.active', comparisonOperator: '=', value: 'true' }\n            ]\n        }\n    );\n});\n"})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"transactions",children:"Transactions"}),"\n",(0,t.jsx)(s.h3,{id:"lockexecute",children:"lockExecute()"}),"\n",(0,t.jsx)(s.p,{children:"Executes a callback with exclusive database access for atomic operations."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"context.storage.lockExecute(callback)\n"})}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsx)(s.tbody,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"callback"})}),(0,t.jsx)(s.td,{children:"function"}),(0,t.jsx)(s.td,{children:"Function to execute with locked access"})]})})]}),"\n",(0,t.jsx)(s.p,{children:"All storage operations inside the callback are executed atomically."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"app.post('/transfer', (request, response) => {\n    var body = JSON.parse(request.body);\n\n    context.storage.lockExecute(function() {\n        var fromBalance = parseFloat(context.storage.getItem(body.from) || '0');\n        var toBalance = parseFloat(context.storage.getItem(body.to) || '0');\n\n        if (fromBalance >= body.amount) {\n            context.storage.setItem(body.from, String(fromBalance - body.amount));\n            context.storage.setItem(body.to, String(toBalance + body.amount));\n            response.end(JSON.stringify({ success: true }));\n        } else {\n            response.end(JSON.stringify({\n                success: false,\n                error: 'Insufficient funds'\n            }));\n        }\n    });\n});\n"})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"file-operations",children:"File Operations"}),"\n",(0,t.jsx)(s.h3,{id:"savefile",children:"saveFile()"}),"\n",(0,t.jsx)(s.p,{children:"Saves a file to the mim's working folder."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"context.storage.saveFile(fileName, base64Data)\n"})}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"fileName"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Name of the file to save"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"base64Data"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"File content as base64-encoded string"})]})]})]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"app.post('/upload', (request, response) => {\n    var body = JSON.parse(request.body);\n    context.storage.saveFile(body.fileName, body.data);\n    response.end('File saved');\n});\n"})}),"\n",(0,t.jsx)(s.h3,{id:"deletefile",children:"deleteFile()"}),"\n",(0,t.jsx)(s.p,{children:"Deletes a file from the mim's working folder."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"context.storage.deleteFile(fileName)\n"})}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsx)(s.tbody,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"fileName"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Name of the file to delete"})]})})]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"app.delete('/file/:name', (request, response) => {\n    context.storage.deleteFile(request.params.name);\n    response.end('File deleted');\n});\n"})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsx)(s.h3,{id:"use-key-prefixes",children:"Use Key Prefixes"}),"\n",(0,t.jsx)(s.p,{children:"Organize keys with prefixes to avoid collisions:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"// Good\ncontext.storage.setItem('user:123', userData);\ncontext.storage.setItem('session:abc', sessionData);\ncontext.storage.setItem('config:theme', 'dark');\n\n// Avoid\ncontext.storage.setItem('123', userData);  // Ambiguous\n"})}),"\n",(0,t.jsx)(s.h3,{id:"use-tags-for-collections",children:"Use Tags for Collections"}),"\n",(0,t.jsx)(s.p,{children:"Use tags to group related items:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"// Store with tag\ncontext.storage.setItemWithTag('user:123', userData, 'users');\ncontext.storage.setItemWithTag('user:456', userData, 'users');\n\n// Query all users\ncontext.storage.eachItemByTag('users', function(key, value) {\n    // Process each user\n    return true;\n});\n\n// Delete all users\ncontext.storage.removeItemsByTag('users');\n"})}),"\n",(0,t.jsx)(s.h3,{id:"use-transactions-for-consistency",children:"Use Transactions for Consistency"}),"\n",(0,t.jsxs)(s.p,{children:["Wrap related operations in ",(0,t.jsx)(s.code,{children:"lockExecute"})," to ensure atomicity:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-javascript",children:"context.storage.lockExecute(function() {\n    var counter = parseInt(context.storage.getItem('counter') || '0');\n    context.storage.setItem('counter', String(counter + 1));\n    context.storage.setItem('lastUpdated', new Date().toISOString());\n});\n"})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"related",children:"Related"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"/mimOE-devportal/docs/api/context/http",children:"context.http"}),":  HTTP client API"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"/mimOE-devportal/docs/api/context/info",children:"context.info"}),":  Node metadata and environment"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"/mimOE-devportal/docs/api/context/request",children:"request"}),":  Incoming request object"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"/mimOE-devportal/docs/api/context/response",children:"response"}),":  Response methods"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},8453(e,s,n){n.d(s,{R:()=>d,x:()=>c});var r=n(6540);const t={},i=r.createContext(t);function d(e){const s=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);