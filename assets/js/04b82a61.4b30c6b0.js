"use strict";(globalThis.webpackChunkmimoe_devportal=globalThis.webpackChunkmimoe_devportal||[]).push([[8777],{8453(e,n,r){r.d(n,{R:()=>i,x:()=>d});var s=r(6540);const t={},a=s.createContext(t);function i(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),s.createElement(a.Provider,{value:n},e.children)}},9037(e,n,r){r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"api/context/request","title":"request","description":"Incoming HTTP request object","source":"@site/docs/api/context/request.md","sourceDirName":"api/context","slug":"/api/context/request","permalink":"/mimOE-devportal/docs/api/context/request","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"title":"request","description":"Incoming HTTP request object"},"sidebar":"apiSidebar","previous":{"title":"context.info & context.env","permalink":"/mimOE-devportal/docs/api/context/info"},"next":{"title":"response","permalink":"/mimOE-devportal/docs/api/context/response"}}');var t=r(4848),a=r(8453);const i={sidebar_position:5,title:"request",description:"Incoming HTTP request object"},d="request",o={},l=[{value:"Properties",id:"properties",level:2},{value:"Methods",id:"methods",level:2},{value:"url",id:"url",level:2},{value:"Parsing Query Parameters",id:"parsing-query-parameters",level:3},{value:"method",id:"method",level:2},{value:"headers",id:"headers",level:2},{value:"Common Headers",id:"common-headers",level:3},{value:"body",id:"body",level:2},{value:"Handling JSON Body",id:"handling-json-body",level:3},{value:"authorization",id:"authorization",level:2},{value:"Passing Token to Other Services",id:"passing-token-to-other-services",level:3},{value:"handleFormRequest()",id:"handleformrequest",level:2},{value:"Options",id:"options",level:3},{value:"found Callback",id:"found-callback",level:3},{value:"Actions",id:"actions",level:3},{value:"Example: File Upload",id:"example-file-upload",level:3},{value:"Example: Profile Update with Avatar",id:"example-profile-update-with-avatar",level:3},{value:"Router Parameters",id:"router-parameters",level:2},{value:"Related",id:"related",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"request",children:"request"})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"request"})," object represents the incoming HTTP request to your mim. It is passed as the second parameter to your mim handler."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"mimikModule.exports = (context, request, response) => {\n    // request contains incoming HTTP data\n};\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"properties",children:"Properties"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Property"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"#url",children:(0,t.jsx)(n.code,{children:"url"})})}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsx)(n.td,{children:"Full URL including query string"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"#method",children:(0,t.jsx)(n.code,{children:"method"})})}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsx)(n.td,{children:"HTTP method (GET, POST, PUT, DELETE, etc.)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"#headers",children:(0,t.jsx)(n.code,{children:"headers"})})}),(0,t.jsx)(n.td,{children:"object"}),(0,t.jsx)(n.td,{children:"HTTP headers (lowercase keys)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"#body",children:(0,t.jsx)(n.code,{children:"body"})})}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsx)(n.td,{children:"Request body (for POST/PUT requests)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"#authorization",children:(0,t.jsx)(n.code,{children:"authorization"})})}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsx)(n.td,{children:"Authorization header value"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"methods",children:"Methods"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Method"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"#handleformrequest",children:(0,t.jsx)(n.code,{children:"handleFormRequest(options)"})})}),(0,t.jsx)(n.td,{children:"Handle multipart/form-data for file uploads"})]})})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"url",children:"url"}),"\n",(0,t.jsx)(n.p,{children:"The full URL of the request including the query string."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"app.get('/users', (request, response) => {\n    console.log(request.url);\n    // \"/users?page=1&limit=10\"\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"parsing-query-parameters",children:"Parsing Query Parameters"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"app.get('/search', (request, response) => {\n    // Simple query parsing\n    var url = request.url;\n    var queryStart = url.indexOf('?');\n\n    if (queryStart !== -1) {\n        var queryString = url.substring(queryStart + 1);\n        var params = {};\n\n        queryString.split('&').forEach(function(pair) {\n            var parts = pair.split('=');\n            params[decodeURIComponent(parts[0])] = decodeURIComponent(parts[1] || '');\n        });\n\n        response.end(JSON.stringify(params));\n    } else {\n        response.end('{}');\n    }\n});\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"method",children:"method"}),"\n",(0,t.jsx)(n.p,{children:"The HTTP method of the request."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"app.all('/resource', (request, response) => {\n    if (request.method === 'GET') {\n        // Handle GET\n        response.end('GET request');\n    } else if (request.method === 'POST') {\n        // Handle POST\n        response.end('POST request');\n    } else if (request.method === 'PUT') {\n        // Handle PUT\n        response.end('PUT request');\n    } else if (request.method === 'DELETE') {\n        // Handle DELETE\n        response.end('DELETE request');\n    } else {\n        response.statusCode = 405;\n        response.end('Method not allowed');\n    }\n});\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"headers",children:"headers"}),"\n",(0,t.jsxs)(n.p,{children:["HTTP headers as a key-value object. Header names are ",(0,t.jsx)(n.strong,{children:"lowercase"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"app.post('/data', (request, response) => {\n    var contentType = request.headers['content-type'];\n    var userAgent = request.headers['user-agent'];\n    var customHeader = request.headers['x-custom-header'];\n\n    response.end(JSON.stringify({\n        contentType: contentType,\n        userAgent: userAgent,\n        customHeader: customHeader\n    }));\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"common-headers",children:"Common Headers"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"app.get('/headers', (request, response) => {\n    response.end(JSON.stringify({\n        contentType: request.headers['content-type'],\n        accept: request.headers['accept'],\n        userAgent: request.headers['user-agent'],\n        host: request.headers['host'],\n        origin: request.headers['origin'],\n        referer: request.headers['referer']\n    }));\n});\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"body",children:"body"}),"\n",(0,t.jsxs)(n.p,{children:["The request body as a string. Available for POST, PUT, and PATCH requests when the Content-Type is ",(0,t.jsx)(n.code,{children:"application/json"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"app.post('/users', (request, response) => {\n    var user = JSON.parse(request.body);\n\n    console.log(user.name);\n    console.log(user.email);\n\n    // Save user...\n    response.statusCode = 201;\n    response.end(JSON.stringify({ id: 123, created: true }));\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"handling-json-body",children:"Handling JSON Body"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"app.post('/data', (request, response) => {\n    try {\n        var data = JSON.parse(request.body);\n        // Process data...\n        response.end(JSON.stringify({ success: true }));\n    } catch (e) {\n        response.statusCode = 400;\n        response.end(JSON.stringify({ error: 'Invalid JSON' }));\n    }\n});\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"authorization",children:"authorization"}),"\n",(0,t.jsx)(n.p,{children:"The Authorization header value, typically containing a Bearer token."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"app.get('/protected', (request, response) => {\n    if (!request.authorization) {\n        response.statusCode = 401;\n        response.end('Unauthorized');\n        return;\n    }\n\n    // Extract token from \"Bearer <token>\"\n    var parts = request.authorization.split(' ');\n    if (parts[0] !== 'Bearer' || !parts[1]) {\n        response.statusCode = 401;\n        response.end('Invalid authorization format');\n        return;\n    }\n\n    var token = parts[1];\n    // Validate token...\n\n    response.end('Access granted');\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"passing-token-to-other-services",children:"Passing Token to Other Services"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"app.get('/proxy', (request, response) => {\n    context.http.request({\n        url: 'http://127.0.0.1:' + context.info.httpPort + '/other-mim/v1/data',\n        authorization: request.authorization,  // Forward the token\n        success: function(result) {\n            response.end(result.data);\n        },\n        error: function(err) {\n            response.statusCode = err.status || 500;\n            response.end(err.message);\n        }\n    });\n});\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"handleformrequest",children:"handleFormRequest()"}),"\n",(0,t.jsxs)(n.p,{children:["Handles ",(0,t.jsx)(n.code,{children:"multipart/form-data"})," POST requests for file uploads and form fields."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"request.handleFormRequest(options)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"options",children:"Options"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Option"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"found"})}),(0,t.jsx)(n.td,{children:"function"}),(0,t.jsx)(n.td,{children:"Called when a field/file is found; returns action"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"get"})}),(0,t.jsx)(n.td,{children:"function"}),(0,t.jsxs)(n.td,{children:["Called with field value when action is ",(0,t.jsx)(n.code,{children:"'get'"})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"store"})}),(0,t.jsx)(n.td,{children:"function"}),(0,t.jsxs)(n.td,{children:["Called after file is stored when action is ",(0,t.jsx)(n.code,{children:"'store'"})]})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"found-callback",children:"found Callback"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"found: (name, filename) => {\n    // name: field name\n    // filename: file name (empty string for text fields)\n\n    return {\n        action: 'get' | 'store' | 'skip' | 'abort',\n        path: '/path/to/save'  // Required for 'store' action\n    };\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"actions",children:"Actions"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Action"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"'get'"})}),(0,t.jsxs)(n.td,{children:["Process as text field; triggers ",(0,t.jsx)(n.code,{children:"get()"})," callback"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"'store'"})}),(0,t.jsxs)(n.td,{children:["Save as file; triggers ",(0,t.jsx)(n.code,{children:"store()"})," callback"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"'skip'"})}),(0,t.jsx)(n.td,{children:"Ignore this field"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"'abort'"})}),(0,t.jsx)(n.td,{children:"Stop processing the form"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"example-file-upload",children:"Example: File Upload"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"app.post('/upload', (request, response) => {\n    var uploadedFiles = [];\n    var formFields = {};\n\n    request.handleFormRequest({\n        found: function(name, filename) {\n            if (filename) {\n                // It's a file\n                if (filename.endsWith('.jpg') || filename.endsWith('.png')) {\n                    return { action: 'store', path: 'uploads/' + filename };\n                }\n                return { action: 'skip' };  // Skip non-image files\n            }\n            // It's a text field\n            return { action: 'get' };\n        },\n        get: function(name, value) {\n            formFields[name] = value;\n        },\n        store: function(filepath, bytesStored) {\n            uploadedFiles.push({\n                path: filepath,\n                size: bytesStored\n            });\n        }\n    });\n\n    response.end(JSON.stringify({\n        files: uploadedFiles,\n        fields: formFields\n    }));\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"example-profile-update-with-avatar",children:"Example: Profile Update with Avatar"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"app.post('/profile', (request, response) => {\n    var profile = {};\n    var avatarPath = null;\n\n    request.handleFormRequest({\n        found: function(name, filename) {\n            if (name === 'avatar' && filename) {\n                var ext = filename.split('.').pop();\n                avatarPath = 'avatars/user-' + Date.now() + '.' + ext;\n                return { action: 'store', path: avatarPath };\n            }\n            return { action: 'get' };\n        },\n        get: function(name, value) {\n            profile[name] = value;\n        },\n        store: function(filepath, bytesStored) {\n            profile.avatar = filepath;\n            profile.avatarSize = bytesStored;\n        }\n    });\n\n    // Save profile...\n    context.storage.setItem('profile:' + profile.id, JSON.stringify(profile));\n    response.end(JSON.stringify({ success: true, profile: profile }));\n});\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"router-parameters",children:"Router Parameters"}),"\n",(0,t.jsxs)(n.p,{children:["When using a router library, route parameters are typically available on ",(0,t.jsx)(n.code,{children:"request.params"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"import Router from 'router';\nvar app = Router({ mergeParams: true });\n\napp.get('/users/:id', (request, response) => {\n    var userId = request.params.id;\n    // ...\n});\n\napp.get('/posts/:postId/comments/:commentId', (request, response) => {\n    var postId = request.params.postId;\n    var commentId = request.params.commentId;\n    // ...\n});\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"related",children:"Related"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/mimOE-devportal/docs/api/context/response",children:"response"}),":  Response methods"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/mimOE-devportal/docs/api/context/http",children:"context.http"}),":  HTTP client API"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/mimOE-devportal/docs/api/context/storage",children:"context.storage"}),":  Persistent storage API"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/mimOE-devportal/docs/api/context/info",children:"context.info"}),":  Node metadata and environment"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);