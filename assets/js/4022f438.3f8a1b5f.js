"use strict";(globalThis.webpackChunkmimoe_devportal=globalThis.webpackChunkmimoe_devportal||[]).push([[4112],{3256(e,n,s){s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"api/context/http","title":"context.http","description":"HTTP client API for making outbound requests from mims","source":"@site/docs/api/context/http.md","sourceDirName":"api/context","slug":"/api/context/http","permalink":"/webdemo/docs/api/context/http","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"context.http","description":"HTTP client API for making outbound requests from mims"},"sidebar":"apiSidebar","previous":{"title":"JavaScript mim Runtime API","permalink":"/webdemo/docs/api/context/"},"next":{"title":"context.storage","permalink":"/webdemo/docs/api/context/storage"}}');var t=s(4848),a=s(8453);const i={sidebar_position:2,title:"context.http",description:"HTTP client API for making outbound requests from mims"},o="context.http",d={},l=[{value:"request()",id:"request",level:2},{value:"Parameters",id:"parameters",level:3},{value:"Options",id:"options",level:3},{value:"Success Callback",id:"success-callback",level:3},{value:"Error Callback",id:"error-callback",level:3},{value:"Examples",id:"examples",level:2},{value:"Simple GET Request",id:"simple-get-request",level:3},{value:"GET with Headers",id:"get-with-headers",level:3},{value:"POST with JSON Body",id:"post-with-json-body",level:3},{value:"PUT Request",id:"put-request",level:3},{value:"DELETE Request",id:"delete-request",level:3},{value:"With Timeouts",id:"with-timeouts",level:3},{value:"Download to File",id:"download-to-file",level:3},{value:"Calling Other mims",id:"calling-other-mims",level:2},{value:"Calling AI Inference",id:"calling-ai-inference",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Use Environment Variables for Credentials",id:"use-environment-variables-for-credentials",level:3},{value:"Set Appropriate Timeouts",id:"set-appropriate-timeouts",level:3},{value:"Validate Responses",id:"validate-responses",level:3},{value:"Related",id:"related",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"contexthttp",children:"context.http"})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"context.http"})," object provides an HTTP client for making outbound requests from your mim. All requests are asynchronous and use callback functions for handling responses."]}),"\n",(0,t.jsx)(n.h2,{id:"request",children:"request()"}),"\n",(0,t.jsx)(n.p,{children:"Makes an HTTP request to an external URL."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"context.http.request(options)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"parameters",children:"Parameters"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Parameter"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Required"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"options"})}),(0,t.jsx)(n.td,{children:"object"}),(0,t.jsx)(n.td,{children:"Yes"}),(0,t.jsx)(n.td,{children:"Request configuration object"})]})})]}),"\n",(0,t.jsx)(n.h3,{id:"options",children:"Options"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Option"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Default"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"url"})}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsx)(n.td,{children:":"}),(0,t.jsx)(n.td,{children:"Target URL (required)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"type"})}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'"GET"'})}),(0,t.jsxs)(n.td,{children:["HTTP method: ",(0,t.jsx)(n.code,{children:'"GET"'}),", ",(0,t.jsx)(n.code,{children:'"POST"'}),", ",(0,t.jsx)(n.code,{children:'"PUT"'}),", ",(0,t.jsx)(n.code,{children:'"DELETE"'}),", etc."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"data"})}),(0,t.jsx)(n.td,{children:"string | object"}),(0,t.jsx)(n.td,{children:":"}),(0,t.jsx)(n.td,{children:"Request body; objects are automatically JSON-encoded"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"headers"})}),(0,t.jsx)(n.td,{children:"object"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"{}"})}),(0,t.jsx)(n.td,{children:"HTTP headers as key-value pairs"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"authorization"})}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsx)(n.td,{children:":"}),(0,t.jsxs)(n.td,{children:["Authorization header value (e.g., ",(0,t.jsx)(n.code,{children:'"Bearer token123"'}),")"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"connectionTimeout"})}),(0,t.jsx)(n.td,{children:"number"}),(0,t.jsx)(n.td,{children:":"}),(0,t.jsx)(n.td,{children:"Connection timeout in milliseconds"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"socketTimeout"})}),(0,t.jsx)(n.td,{children:"number"}),(0,t.jsx)(n.td,{children:":"}),(0,t.jsx)(n.td,{children:"Socket timeout in milliseconds"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"outputFile"})}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsx)(n.td,{children:":"}),(0,t.jsx)(n.td,{children:"Path to save response body to a file"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"success"})}),(0,t.jsx)(n.td,{children:"function"}),(0,t.jsx)(n.td,{children:":"}),(0,t.jsx)(n.td,{children:"Callback invoked on successful response"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"error"})}),(0,t.jsx)(n.td,{children:"function"}),(0,t.jsx)(n.td,{children:":"}),(0,t.jsx)(n.td,{children:"Callback invoked on error"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"success-callback",children:"Success Callback"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"success: (result) => {\n    result.data     // Response body content (string)\n    result.headers  // Response headers (object)\n    result.status   // HTTP status code (number)\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"error-callback",children:"Error Callback"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"error: (error) => {\n    error.message  // Error message (string)\n    error.status   // HTTP status code, if HTTP error (number)\n    error.content  // Response body, if HTTP error (string)\n    error.headers  // Response headers, if HTTP error (object)\n}\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,t.jsx)(n.h3,{id:"simple-get-request",children:"Simple GET Request"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"app.get('/users', (request, response) => {\n    context.http.request({\n        url: 'https://api.example.com/users',\n        success: (result) => {\n            var users = JSON.parse(result.data);\n            response.end(JSON.stringify(users));\n        },\n        error: (err) => {\n            response.statusCode = 500;\n            response.end(err.message);\n        }\n    });\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"get-with-headers",children:"GET with Headers"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"app.get('/protected', (request, response) => {\n    context.http.request({\n        url: 'https://api.example.com/protected',\n        headers: {\n            'X-Custom-Header': 'value'\n        },\n        authorization: 'Bearer ' + context.env.API_TOKEN,\n        success: (result) => {\n            response.end(result.data);\n        },\n        error: (err) => {\n            response.statusCode = err.status || 500;\n            response.end(err.message);\n        }\n    });\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"post-with-json-body",children:"POST with JSON Body"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"app.post('/users', (request, response) => {\n    var userData = JSON.parse(request.body);\n\n    context.http.request({\n        type: 'POST',\n        url: 'https://api.example.com/users',\n        headers: {\n            'Content-Type': 'application/json'\n        },\n        data: userData,  // Objects are auto-JSON-encoded\n        success: (result) => {\n            response.statusCode = 201;\n            response.end(result.data);\n        },\n        error: (err) => {\n            response.statusCode = err.status || 500;\n            response.end(JSON.stringify({ error: err.message }));\n        }\n    });\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"put-request",children:"PUT Request"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"app.put('/users/:id', (request, response) => {\n    var userId = request.params.id;\n    var updates = JSON.parse(request.body);\n\n    context.http.request({\n        type: 'PUT',\n        url: 'https://api.example.com/users/' + userId,\n        headers: {\n            'Content-Type': 'application/json'\n        },\n        authorization: request.authorization,\n        data: updates,\n        success: (result) => {\n            response.end(result.data);\n        },\n        error: (err) => {\n            response.statusCode = err.status || 500;\n            response.end(err.message);\n        }\n    });\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"delete-request",children:"DELETE Request"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"app.delete('/users/:id', (request, response) => {\n    var userId = request.params.id;\n\n    context.http.request({\n        type: 'DELETE',\n        url: 'https://api.example.com/users/' + userId,\n        authorization: request.authorization,\n        success: (result) => {\n            response.end(JSON.stringify({ deleted: true }));\n        },\n        error: (err) => {\n            response.statusCode = err.status || 500;\n            response.end(err.message);\n        }\n    });\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"with-timeouts",children:"With Timeouts"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"app.get('/slow-api', (request, response) => {\n    context.http.request({\n        url: 'https://api.example.com/slow-endpoint',\n        connectionTimeout: 5000,  // 5 seconds to connect\n        socketTimeout: 30000,     // 30 seconds for response\n        success: (result) => {\n            response.end(result.data);\n        },\n        error: (err) => {\n            response.statusCode = 504;\n            response.end('Request timed out');\n        }\n    });\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"download-to-file",children:"Download to File"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"app.get('/download', (request, response) => {\n    context.http.request({\n        url: 'https://example.com/large-file.zip',\n        outputFile: '/data/downloads/file.zip',\n        success: (result) => {\n            response.end(JSON.stringify({\n                saved: true,\n                status: result.status\n            }));\n        },\n        error: (err) => {\n            response.statusCode = 500;\n            response.end(err.message);\n        }\n    });\n});\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"calling-other-mims",children:"Calling Other mims"}),"\n",(0,t.jsx)(n.p,{children:"You can call other mims running on the same mimOE instance:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"app.get('/aggregate', (request, response) => {\n    var port = context.info.httpPort;\n\n    context.http.request({\n        url: 'http://127.0.0.1:' + port + '/other-mim/v1/data',\n        authorization: request.authorization,\n        success: (result) => {\n            var data = JSON.parse(result.data);\n            response.end(JSON.stringify({\n                source: 'other-mim',\n                data: data\n            }));\n        },\n        error: (err) => {\n            response.statusCode = 500;\n            response.end(err.message);\n        }\n    });\n});\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"calling-ai-inference",children:"Calling AI Inference"}),"\n",(0,t.jsx)(n.p,{children:"Call the local mILM inference service:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"app.post('/chat', (request, response) => {\n    var body = JSON.parse(request.body);\n    var port = context.info.httpPort;\n\n    context.http.request({\n        type: 'POST',\n        url: 'http://127.0.0.1:' + port + '/mimik-ai/openai/v1/chat/completions',\n        headers: {\n            'Content-Type': 'application/json'\n        },\n        data: {\n            model: 'my-model',\n            messages: [\n                { role: 'user', content: body.prompt }\n            ]\n        },\n        success: (result) => {\n            var completion = JSON.parse(result.data);\n            response.end(JSON.stringify({\n                reply: completion.choices[0].message.content\n            }));\n        },\n        error: (err) => {\n            response.statusCode = 500;\n            response.end(err.message);\n        }\n    });\n});\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,t.jsx)(n.p,{children:"Always provide an error callback to handle failures gracefully:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"app.get('/data', (request, response) => {\n    context.http.request({\n        url: 'https://api.example.com/data',\n        success: (result) => {\n            response.end(result.data);\n        },\n        error: (err) => {\n            // Check if it's an HTTP error with status code\n            if (err.status) {\n                if (err.status === 404) {\n                    response.statusCode = 404;\n                    response.end('Resource not found');\n                } else if (err.status >= 500) {\n                    response.statusCode = 502;\n                    response.end('Upstream server error');\n                } else {\n                    response.statusCode = err.status;\n                    response.end(err.content || err.message);\n                }\n            } else {\n                // Network or timeout error\n                response.statusCode = 503;\n                response.end('Service unavailable: ' + err.message);\n            }\n        }\n    });\n});\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsx)(n.h3,{id:"use-environment-variables-for-credentials",children:"Use Environment Variables for Credentials"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"context.http.request({\n    url: context.env.EXTERNAL_API_URL + '/endpoint',\n    authorization: 'Bearer ' + context.env.EXTERNAL_API_KEY,\n    // ...\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"set-appropriate-timeouts",children:"Set Appropriate Timeouts"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"context.http.request({\n    url: 'https://api.example.com/data',\n    connectionTimeout: 5000,   // Fail fast if can't connect\n    socketTimeout: 15000,      // Allow time for response\n    // ...\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"validate-responses",children:"Validate Responses"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"success: (result) => {\n    try {\n        var data = JSON.parse(result.data);\n        if (!data.expectedField) {\n            response.statusCode = 502;\n            response.end('Invalid response from upstream');\n            return;\n        }\n        response.end(JSON.stringify(data));\n    } catch (e) {\n        response.statusCode = 502;\n        response.end('Invalid JSON from upstream');\n    }\n}\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"related",children:"Related"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/webdemo/docs/api/context/storage",children:"context.storage"}),":  Persistent storage API"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/webdemo/docs/api/context/info",children:"context.info"}),":  Node metadata and environment"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/webdemo/docs/api/context/request",children:"request"}),":  Incoming request object"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/webdemo/docs/api/context/response",children:"response"}),":  Response methods"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453(e,n,s){s.d(n,{R:()=>i,x:()=>o});var r=s(6540);const t={},a=r.createContext(t);function i(e){const n=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);